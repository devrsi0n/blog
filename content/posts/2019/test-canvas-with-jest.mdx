---
title: jest 测试 canvas
author: Devrsi0n
date: '2019-10-19'
hero: /static/2019/test-canvas-with-jest/hero.jpg
excerpt: jest 测试 canvas 小技巧
---

[jest](https://jestjs.io) 是个简单好用的单测工具，自带 [JSDOM](https://github.com/jsdom/jsdom)，可以在 node 环境模拟浏览器 DOM 环境，方便测试前端代码，但是 JSDOM 并不是万能，部分 DOM API 并未完全实现，比如今天遇到的 [Canvas](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/canvas) 就属于这部分未实现的 API，如果需要写相关测试用例，jest 并未直接提供解决方法。

*随着 JSDOM 的逐步完善此类 API 缺失会越来越少，到时候可以去除这类 mock。*

## 解决步骤

[jest-canvas-mock](https://github.com/hustcc/jest-canvas-mock) 就是为解决这个问题而生，参考文档配置即可。

安装依赖

```shell
npm i -S jest-canvas-mock
```

配置 jest

```json
{
  "setupFiles": ["jest-canvas-mock"]
}
```

## More

JSDOM 缺失的 mock（例如：fetch、localstorage 等） 可以在 [这里](https://github.com/jest-community/awesome-jest#mocks) 找到解决办法。
